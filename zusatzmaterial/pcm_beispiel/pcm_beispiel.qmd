# Beispielrechnung PCM

In der Vorlesung begegnet Ihnen eine Beispielrechnung zu den Kategorienwahrscheinlichkeiten im Partial Credit Model. Es soll berechnet werden, wie wahrscheinlich es ist, dass eine Person mit einer Fähigkeit von $\theta_i = 0.5$ in der Antwortkategorie $c = 2$ einer 4-stufigen Ratingskala antwortet. Die Schwellenparameter $\delta_{j1} = -1$, $\delta_{j2} = 0$, und $\delta_{j3} = 1$ sind vorgegeben.

## Interpretation der Parameter

Als erstes lohnt es sich zu verstehen, wie die Bezeichnungen der Antwortkategorien und Schwellenparameter gemeint sind. Dafür hilft es, die Ratingskala zu skizzieren:

![](images/scale.png){width=80%}

Unter den Kästchen (Antwortkategorien) steht die Bezeichnung der Antwortkategorien. Üblicherweise zählen wir im PCM beginnend mit der $0$. Eine Antwort in der $c=2^{\text{ten}}$ Kategorie entspricht also eigentlich einer Antwort in der dritthöchsten Kategorie. An dieser Stelle wurde in der Abbildung symbolisch ein Kreuz gesetzt.

Die Schwellenparameter entsprechen den Schwierigkeiten eines "Sprungs" von einer Kategorie in die nächsthöchte. Der Schwellenparameter $\delta_{j1}$ wird für den "Sprung" von Kategorie $0$ zu Kategorie $1$ verwendet. Dort finden Sie ihn auch in der Abbildung. Entsprechend wurden auch die Schwellenparameter $\delta_{j2}$ und $\delta_{j3}$ eingefügt.

## Gegebene Werte

Oben ist bereits beschrieben, dass die Parameter $\theta_i = 0.5$, $\delta_{j1} = -1$, $\delta_{j2} = 0$, $\delta_{j3} = 1$, und $c = 2$ gegeben sind. Aus der Abbildung der Ratingskala können wir zusätzlich ablesen, dass auch die höchste Antwortkategorie, also $m_j = 3$ gegeben ist.

## Gesuchte Kategorienwahrscheinlichkeit

Gesucht ist die Wahrscheinlichkeit

$P(u_{ij} = 2 | \theta_i, \delta_{j1}, \delta_{j2}, \delta_{j3})$

$= \frac{exp(\sum_{k = 0}^{c} (\theta_i - \delta_{jk}))}{\sum_{l = 0}^{m_j} exp(\sum_{k = 0}^{l} (\theta_i - \delta_{jk}))}$

Der Bruch wirkt eventuell zuerst erschlagend. Als kleinen ersten Schritt können wir die gegebenen Werte $c = 2$ und $m_j = 3$ einsetzen:

$= \frac{exp(\sum_{k = 0}^{\textcolor{red}{2}} (\theta_i - \delta_{jk}))}{\sum_{l = 0}^{\textcolor{red}{3}} exp(\sum_{k = 0}^{l} (\theta_i - \delta_{jk}))}$

Als nächstes ist es hilreich festzustellen, dass sich im Zähler, wie auch im Nenner, die Summe über Differenzen $\theta_i - \delta_{jk}$ wiederholt. Ich markiere diese Summe im Folgenden rot:

$= \frac{exp(\textcolor{red}{\sum_{k = 0}^{2} (\theta_i - \delta_{jk})})}{\sum_{l = 0}^{3} exp(\textcolor{red}{\sum_{k = 0}^{l} (\theta_i - \delta_{jk})})}$

Die rot markierte Summe müssen Sie bei der Berechnung des PCM oft verwenden. Daher lohnt es sich, die Berechnung abzukürzen.

## Berechnung der farblich markierten Summe

Als Zwischenschritt nehme ich die oben rot markierte Summe heraus. Insbesondere wähle ich den schwierigsten Fall, nämlich den, in dem Sie die Summe bis $m_j = 3$ berechnen müssen:

$\sum_{k = 0}^{3} (\theta_i - \delta_{jk})$

Auflösen des Summenzeichens ergibt:

$= (\theta_i - \delta_{j0}) + (\theta_i - \delta_{j1}) + (\theta_i - \delta_{j2}) + (\theta_i - \delta_{j3})$

Die erste Differenz mit $\delta_{j0}$ können wir gleich wieder streichen, denn diese ist als $0$ definiert.

$=(\theta_i - \delta_{j1}) + (\theta_i - \delta_{j2}) + (\theta_i - \delta_{j3})$

Da das Assoziativ- und Kommutativgesetz gelten, dürfen wir die Klammern auflösen und neu sortieren:

$= 3 \cdot \theta_i - \delta_{j1} - \delta_{j2} - \delta_{j3}$

Statt das Summenzeichen aufwendig für jeden Wert von $k$ aufzulösen, können Sie also gleich $\theta_i$ mit $3$ multiplizieren und den ersten bis dritten Schwellenparameter abziehen. Das geht viel schneller und funktioniert *im PCM* bei Summen der Form $\sum_{k = 0}^{l} (\theta_i - \delta_{jk})$ immer dann, wenn als obere Grenze im Summenzeichen eine Zahl $\ge 1$ steht.

::: {.callout-aufgabe}

Lösen Sie auf:

$\sum_{k = 0}^{2} (\theta_i - \delta_{jk})$

:::

::: {.callout-tip title="Lösung" collapse="true"}

$\sum_{k = 0}^{2} (\theta_i - \delta_{jk}) = 2 \cdot \theta_i - \delta_{j1} - \delta_{j2}$

:::

Aufpassen muss man nur im Sonderfall, der als $0$ definiert ist:

$\sum_{k = 0}^{0} (\theta_i - \delta_{jk}) := 0$

## Berechnung der Kategorienwahrscheinlichkeit

Mit diesem Wissen können wir zur Berechnung der gesamten Kategorienwahrscheinlichkeit zurückkehren:

$P(u_{ij} = 2 | \theta_i, \delta_{j1}, \delta_{j2}, \delta_{j3})$

$= \frac{exp(\sum_{k = 0}^{2} (\theta_i - \delta_{jk}))}{\sum_{l = 0}^{3} exp(\sum_{k = 0}^{l} (\theta_i - \delta_{jk}))}$

Der Zähler lässt sich mit dem eben gezeigten Trick schnell berechnen:

$= \frac{exp(2 \cdot \theta_i - \delta_{j1} - \delta_{j2})}{\sum_{l = 0}^{3} exp(\sum_{k = 0}^{l} (\theta_i - \delta_{jk}))}$

Im Nenner müssen Sie den Trick mehrfach anwenden, nämlich einmal für jedes $l$ zwischen $0$ und $3$:

$= \frac{exp(2 \cdot \theta_i - \delta_{j1} - \delta_{j2})}{
    exp(0) + 
    exp(1\cdot \theta_i - \delta_{j1}) + 
    exp(2\cdot \theta_i - \delta_{j1}- \delta_{j2}) + 
    exp(3\cdot \theta_i - \delta_{j1}- \delta_{j2}- \delta_{j3})
}$

Nun kann man schon Werte einsetzen:

$= \frac{exp(2 \cdot 0.5 - (-1) - 0)}{
    exp(0) + 
    exp(1\cdot 0.5 - (-1)) + 
    exp(2\cdot 0.5 - (-1) - 0) + 
    exp(3\cdot 0.5 - (-1) - 0 - 1)
}$

Schrittweises Ausrechnen ergibt:

$= \frac{7.39}{
    1 + 
    4.48 + 
    7.39 + 
    4.48
} \approx 0.43$

Die modellimplizierte Wahrscheinlichkeit im PCM, dass eine Person mit $\theta_i = 0.5$ bei einem Item mit $\delta_{j1} = -1$, $\delta_{j2} = 0$, und $\delta_{j3} = 1$ in Kategorie $c = 2$ antwortet ist also $0.43$.
